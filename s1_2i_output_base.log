S1_2I.R - 1000 REPS - SHOULD AGREE EXACTLY WITH KIM'S CODE

> # Ian's addition to view output
> # patterns
> patternV
[[1]]
[1]  2  3  5  8 10

[[2]]
[1] 1 2 3 4 5 6 7

[[3]]
[1]  1  2  4  9 10

[[4]]
[1]  1  2  3  5  6  8 10

[[5]]
[1] 1 2 3 4 6 7

[[6]]
[1]  2  3  4  5  6  7  8  9 10

[[7]]
 [1]  1  2  3  4  5  6  7  8  9 10

[[8]]
[1]  3  4  5  6  7  8  9 10


> # pattern prevalences
> lambda
[1] 0.2 0.2 0.1 0.1 0.1 0.1 0.1 0.1

> # treatment effects
> phi_1.2
 [1] -0.81093022 -0.58525822 -0.39256170 -0.22314355 -0.07095174  0.06805346  0.19671029  0.31709596  0.43078292
[10]  0.53899650

> # p(y|row=pattern, col=treatment) 
> res_rate_mat
           [,1]       [,2]       [,3]       [,4]      [,5]       [,6]       [,7]       [,8]       [,9]
[1,] 0.10000000 0.12222222 0.14444444 0.16666667 0.1888889 0.21111111 0.23333333 0.25555556 0.27777778
[2,] 0.02285714 0.02847896 0.03432343 0.04040404 0.0467354 0.05333333 0.06021505 0.06739927 0.07490637
[3,] 0.06153846 0.07593480 0.09060987 0.10557185 0.1208292 0.13639083 0.15226586 0.16846389 0.18499486
[4,] 0.15094340 0.18219462 0.21267894 0.24242424 0.2714571 0.29980276 0.32748538 0.35452794 0.38095238
[5,] 0.20298507 0.24194070 0.27901105 0.31432974 0.3480181 0.38018637 0.41093525 0.44035664 0.46853468
[6,] 0.26105263 0.30686164 0.34929577 0.38871473 0.4254289 0.45970732 0.49178470 0.52186642 0.55013310
[7,] 0.32625698 0.37766020 0.42389726 0.46570973 0.5037037 0.53837943 0.57015342 0.59937528 0.62634063
[8,] 0.40000000 0.45517241 0.50322581 0.54545455 0.5828571 0.61621622 0.64615385 0.67317073 0.69767442
          [,10]
[1,] 0.30000000
[2,] 0.08275862
[3,] 0.20186916
[4,] 0.40677966
[5,] 0.49554656
[6,] 0.57674419
[7,] 0.65130112
[8,] 0.72000000

> # overall PMs
> scenario_out$estimand2 
          mortality_gain better_treatment_I best_treatment_I nearbest_treatment_5 nearbest_treatment_10
method_A     -0.05246304             0.8472           0.3899               0.7359                0.8604
method_B1    -0.06231025             0.9168           0.4649               0.8046                0.9094
method_B2    -0.07175437             0.9532           0.5822               0.8608                0.9478
method_B3    -0.07658950             0.9798           0.6257               0.8915                0.9698
method_C     -0.07699584             0.9820           0.6340               0.8934                0.9709
method_D     -0.07517947             0.9751           0.6003               0.8815                0.9652

> scenario_out$estimand2_MCSE
              Mortaliy better_treatment_I best_treatment_I nearbest_treatment_5 nearbest_treatment_10
method_A  0.0005445204        0.011377705       0.01542329          0.013940990           0.010959555
method_B1 0.0005924311        0.008733714       0.01577238          0.012538694           0.009076984
method_B2 0.0006132347        0.006679054       0.01559625          0.010946386           0.007033858
method_B3 0.0004922944        0.004448816       0.01530358          0.009835027           0.005411835
method_C  0.0005041997        0.004204284       0.01523299          0.009758916           0.005315373
method_D  0.0005767848        0.004927473       0.01548999          0.010220457           0.005795598

> # Better treatment by pattern
> scenario_out$ex_performance_out$better_treatment_I
           [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
method_A  0.975 0.748 0.944 0.797 0.831 0.809 0.845 0.800
method_B1 0.997 0.871 0.985 0.891 0.898 0.889 0.845 0.924
method_B2 0.997 0.926 0.984 0.911 0.912 0.966 0.960 0.953
method_B3 0.998 0.982 0.998 0.982 0.947 0.966 0.996 0.949
method_C  0.998 0.987 0.996 0.984 0.952 0.969 0.996 0.953
method_D  0.996 0.974 0.997 0.973 0.945 0.965 0.985 0.946

> round(sqrt(scenario_out$ex_performance_out$better_treatment_I*(1-scenario_out$ex_performance_out$better_treatment_I)/Nreps),4)
            [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]
method_A  0.0049 0.0137 0.0073 0.0127 0.0119 0.0124 0.0114 0.0126
method_B1 0.0017 0.0106 0.0038 0.0099 0.0096 0.0099 0.0114 0.0084
method_B2 0.0017 0.0083 0.0040 0.0090 0.0090 0.0057 0.0062 0.0067
method_B3 0.0014 0.0042 0.0014 0.0042 0.0071 0.0057 0.0020 0.0070
method_C  0.0014 0.0036 0.0020 0.0040 0.0068 0.0055 0.0020 0.0067
method_D  0.0020 0.0050 0.0017 0.0051 0.0072 0.0058 0.0038 0.0071

> # Best treatment by pattern
> scenario_out$ex_performance_out$best_treatment_I
           [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
method_A  0.523 0.296 0.467 0.381 0.432 0.360 0.283 0.338
method_B1 0.646 0.362 0.522 0.455 0.509 0.418 0.283 0.446
method_B2 0.666 0.545 0.622 0.572 0.568 0.567 0.532 0.539
method_B3 0.667 0.617 0.649 0.654 0.628 0.588 0.629 0.541
method_C  0.684 0.630 0.663 0.653 0.632 0.592 0.629 0.543
method_D  0.672 0.579 0.622 0.602 0.586 0.583 0.578 0.530

> round(sqrt(scenario_out$ex_performance_out$best_treatment_I*(1-scenario_out$ex_performance_out$best_treatment_I)/Nreps),4)
            [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]
method_A  0.0158 0.0144 0.0158 0.0154 0.0157 0.0152 0.0142 0.0150
method_B1 0.0151 0.0152 0.0158 0.0157 0.0158 0.0156 0.0142 0.0157
method_B2 0.0149 0.0157 0.0153 0.0156 0.0157 0.0157 0.0158 0.0158
method_B3 0.0149 0.0154 0.0151 0.0150 0.0153 0.0156 0.0153 0.0158
method_C  0.0147 0.0153 0.0149 0.0151 0.0153 0.0155 0.0153 0.0158
method_D  0.0148 0.0156 0.0153 0.0155 0.0156 0.0156 0.0156 0.0158